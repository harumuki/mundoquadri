/*! For license information please see 49dd63ada79bbaeb2c61.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{278:function(t,e,s){},315:function(t,e,s){"use strict";var r=s(278);s.n(r).a},345:function(t,e,s){"use strict";s.r(e);s(12),s(7),s(21),s(208),s(8),s(10),s(209);var r=s(50),a=(s(202),s(51),s(41),s(68),s(29),s(145),s(23),s(39)),i=s(206);const n={items:{en_us:"items",pt_br:"itens"},filter:{en_us:"filter",pt_br:"filtrar"},results:{en_us:"results",pt_br:"resultados"},sort:{en_us:"sort",pt_br:"ordenar"},searching_for:{en_us:"Searching for",pt_br:"Buscando por"},no_results_for:{en_us:"No results for",pt_br:"Nenhum resultado para"},brands:{en_us:"Brands",pt_br:"Marcas"},categories:{en_us:"Categories",pt_br:"Categorias"},refine_search:{en_us:"Refine search",pt_br:"Refinar busca"},close_filters:{en_us:"Close filters",pt_br:"Fechar filtros"},clear_filters:{en_us:"Clear filters",pt_br:"Limpar filtros"},relevance:{en_us:"Most relevant",pt_br:"Mais relevantes"},sales:{en_us:"Best sellers",pt_br:"Mais vendidos"},lowest_price:{en_us:"Lowest price",pt_br:"Menor preço"},highest_price:{en_us:"Highest price",pt_br:"Maior preço"},popular_products:{en_us:"Popular products",pt_br:"Produtos populares"},search_again:{en_us:"Search again",pt_br:"Buscar novamente"}};var o={name:"EcSearchEngine",components:{EcProductCard:s(228).a},props:{lang:{type:String,default:a.$ecomConfig.get("lang")},storeId:{type:Number,default:a.$ecomConfig.get("store_id")},term:{type:String},page:{type:Number},pageSize:{type:Number},brands:{type:Array},categories:{type:Array},autoFixScore:{type:[Number,Boolean],default:.6},showFilters:{type:Boolean,default:!1},navbarId:String,prerenderedHTML:String},data(){return{ecomSearch:new i.a(this.storeId),currentPage:0,resultItems:[],fixedTerm:"",totalSearchResults:0,searching:!1,loadingMore:!1,searched:!1,emptyResult:!1,networkError:!1,filters:[],lastSelectedFilter:null,selectedOptions:{},sortOptions:[null,"sales","lowest_price","highest_price"],selectedSortOption:null}},computed:{hasSelectedOptions(){for(const t in this.selectedOptions)if(this.selectedOptions[t]&&this.selectedOptions[t].length)return!0;return!1},countedItems(){return(this.pageSize||24)*(this.currentPage-1)+this.resultItems.length}},methods:{dictionary:function(t,e){return e||(e=this&&this.lang||"en_us"),n[t]&&n[t][e]||""},fixTerm(){if(this.term){let t=this.term,e=!0;if(this.ecomSearch.getTermSuggestions().forEach(({options:s,text:r})=>{if(s.length){const a=s[0];a.score<this.autoFixScore&&(e=!1),t=t.replace(r,a.text)}}),e&&t!==this.term)return this.fixedTerm=t,this.ecomSearch.setSearchTerm(t).history.shift(),this.fetchItems(),!0}return!1},updateFilters(){const t=this.filters.find(({filter:t})=>t===this.lastSelectedFilter);this.filters=t?[t]:[];const e=(t,e,s)=>{if(this.lastSelectedFilter!==t){this.filters.push({filter:t,filterObj:{show:this.filters.length<5,options:e},isSpec:s});const r=this.selectedOptions,a=r[t]?r[t].filter(t=>e.find(({key:e})=>e===t)):[];this.$set(this.selectedOptions,t,a)}};["Brands","Categories"].forEach(t=>{e(t,this.ecomSearch["get".concat(t)]())}),this.ecomSearch.getSpecs().forEach(({key:t,options:s},r)=>{e(t,s,!0)})},fetchItems(t,e){const s=this.ecomSearch;this.searching=!0,this.loadingMore=t>1||this.page>1,s.setPageNumber(t).fetch().then(()=>{if(this.totalSearchResults=s.getTotalCount(),this.totalSearchResults||this.fixedTerm||!this.fixTerm()){if(t?(this.currentPage=t,this.resultItems=this.resultItems.concat(s.getItems())):(this.currentPage=1,this.resultItems=s.getItems()),!this.searched){if(!this.resultItems.length)return s.reset(),this.emptyResult=!0,this.fetchItems();setTimeout(()=>{this.searched=!0},10)}this.updateFilters(),this.networkError=!1}}).catch(s=>{console.error(s),e||s.response&&400===s.response.status?this.networkError=!0:this.fetchItems(t,!0)}).finally(()=>{this.searching=this.loadingMore=!1})},toggleFilters(t=!1){this.$emit("update:showFilters",t)},filterLabel(t){const e=this.dictionary(t.toLowerCase());if(!e&&window._data&&Array.isArray(window._data.grids)){const e=window._data.grids.find(e=>e.grid_id===t);if(e)return e.title||e.grid_id}return e||t},updateSearchFilter(t){const e=this.ecomSearch;let s=this.selectedOptions[t];switch(s.length||(s=null),t){case"Brands":e.setBrandNames(s);break;case"Categories":e.setCategoryNames(s);break;default:e.setSpec(t,s)}},setFilterOption(t,e,s){const r=this.selectedOptions[t];if(s)this.lastSelectedFilter=t,r.push(e);else{const s=r.indexOf(e);s>-1&&r.splice(s,1),r.length||this.lastSelectedFilter!==t||(this.lastSelectedFilter=null)}this.updateSearchFilter(t),this.fetchItems()},clearFilters(){const t=this.selectedOptions;for(const e in t)t[e]&&(t[e]=[],this.updateSearchFilter(e));this.fetchItems()},setSortOrder(t){this.selectedSortOption=t,this.ecomSearch.setSortOrder(t),this.fetchItems()}},created(){const t=this.ecomSearch,e=this.term,s=this.page,r=this.pageSize,a=this.brands,i=this.categories;e&&t.setSearchTerm(e),Array.isArray(a)&&a.length&&t.setBrandNames(a),Array.isArray(i)&&i.length&&t.setCategoryNames(i),t.setPageSize(r||24),this.fetchItems(s||1)},mounted(){if(this.navbarId){const t=this.$refs.nav;document.getElementById(this.navbarId).appendChild(t)}let t;window.addEventListener("scroll",()=>{clearTimeout(t),!this.searching&&this.totalSearchResults>this.countedItems&&(t=setTimeout(()=>{const t=this.$el,e=t.offsetTop,s=t.offsetHeight;window.pageYOffset+window.screen.height>=e+s&&this.fetchItems(this.currentPage+1)},100))})}},c=(s(315),s(90)),l=Object(c.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"ec-search-engine"},[s("nav",{ref:"nav"},[s("portal-target",{attrs:{name:"search-nav"}})],1),s("portal",{attrs:{to:"search-nav"}},[s("transition",{attrs:{"enter-active-class":"animated fadeInDown fast"}},[t.searched&&(t.searching||t.totalSearchResults>8||t.hasSelectedOptions)?s("div",{staticClass:"ec-search-engine__nav"},[t._t("nav",[s("div",{staticClass:"container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-auto"},[s("div",{staticClass:"ec-search-engine__count"},[s("strong",[t._v(t._s(t.totalSearchResults))]),t._v(" "+t._s(t.dictionary("items"))+" "),t.searching?s("div",{staticClass:"spinner-grow ec-search-engine__spinner",attrs:{role:"status"}},[s("span",{staticClass:"sr-only"},[t._v("Loading...")])]):t._e()])]),s("div",{staticClass:"text-right col"},[t.hasSelectedOptions||t.filters.find((function(t){return t.filterObj.options.length}))?s("button",{staticClass:"btn ec-search-engine__toggle",attrs:{type:"button"},on:{click:function(e){return t.toggleFilters(!0)}}},[s("i",{staticClass:"fas fa-filter"}),t._v(" "+t._s(t.dictionary("filter"))+" "),s("span",{staticClass:"d-none d-md-inline"},[t._v(" "+t._s(t.dictionary("results"))+" ")])]):t._e(),s("b-dropdown",{attrs:{variant:"link","toggle-class":"ec-search-engine__toggle",right:"","no-caret":""},scopedSlots:t._u([{key:"button-content",fn:function(){return[s("i",{staticClass:"fas fa-sort"}),s("span",{staticClass:"d-none d-md-inline"},[t._v(" "+t._s(t.dictionary("sort"))+" ")])]},proxy:!0}],null,!1,2883328033)},t._l(t.sortOptions,(function(e,r){return s("b-dropdown-item",{key:"sort-"+r,attrs:{href:"#",active:t.selectedSortOption===e},on:{click:function(s){return s.preventDefault(),t.setSortOrder(e)}}},[t._v(" "+t._s(t.dictionary(e||"relevance"))+" ")])})),1)],1)])])],null,{totalSearchResults:t.totalSearchResults,toggleFilters:t.toggleFilters})],2):t._e()])],1),s("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated slideOutRight"}},[s("aside",{directives:[{name:"show",rawName:"v-show",value:t.showFilters,expression:"showFilters"}],staticClass:"ec-search-engine__sidebar card shadow"},[t._t("filters",[s("header",{staticClass:"card-header"},[t._v(" "+t._s(t.dictionary("refine_search"))+" "),s("button",{staticClass:"close",attrs:{type:"button","aria-label":t.dictionary("close_filters")},on:{click:function(e){return t.toggleFilters(!1)}}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),s("div",{staticClass:"card-body"},t._l(t.filters,(function(e){var r=e.filter,a=e.filterObj,i=e.isSpec;return a.options.length?s("div",{key:"filters-"+r,staticClass:"ec-search-engine__filter",class:"ec-search-engine__filter--"+r},[s("button",{staticClass:"btn ec-search-engine__filter__btn",attrs:{type:"button","aria-expanded":a.show?"true":"false","aria-controls":"collapse-"+r},on:{click:function(t){a.show=!a.show}}},[s("i",{staticClass:"fas fa-chevron-down"}),t._v(" "+t._s(t.filterLabel(r))+" ")]),s("b-collapse",{attrs:{id:"collapse-"+r},model:{value:a.show,callback:function(e){t.$set(a,"show",e)},expression:"filterObj.show"}},t._l(a.options,(function(e,a){return s("div",{key:r+"-"+a,staticClass:"custom-control custom-checkbox ec-search-engine__option"},[s("input",{staticClass:"custom-control-input",attrs:{type:"checkbox",id:r+"-"+a},domProps:{checked:t.selectedOptions[r].indexOf(e.key)>-1},on:{change:function(s){return t.setFilterOption(r,e.key,s.target.checked)}}}),s("label",{staticClass:"custom-control-label",attrs:{for:r+"-"+a}},[t._v(" "+t._s(e.key)+" "),i?t._e():s("small",[t._v(" ("+t._s(e.doc_count)+") ")])])])})),0)],1):t._e()})),0),s("footer",{staticClass:"card-footer"},[s("button",{staticClass:"btn btn-sm btn-block btn-outline-secondary",attrs:{type:"button"},on:{click:t.clearFilters}},[s("span",{staticClass:"mr-1"},[s("i",{staticClass:"fas fa-trash-alt"})]),t._v(" "+t._s(t.dictionary("clear_filters"))+" ")])])])],2)]),s("transition",{attrs:{"enter-active-class":"animated fadeIn slower"}},[t.searched?s("div",{staticClass:"ec-search-engine__results",style:{opacity:t.searching&&!t.loadingMore?.4:1}},[s("div",{staticClass:"ec-search-engine__info"},[t.term?[t.emptyResult?s("div",{staticClass:"ec-search-engine__no-results"},[s("div",{staticClass:"lead"},[t._v(" "+t._s(t.dictionary("no_results_for"))+" "),s("em",[t._v(t._s(t.term))])]),s("h1",[t._v(t._s(t.dictionary("popular_products")))])]):s("div",{staticClass:"ec-search-engine__terms"},[s("h1",[s("small",{staticClass:"d-none d-md-block"},[t._v(" "+t._s(t.dictionary("searching_for"))+": ")]),t._v(" "+t._s(t.fixedTerm||t.term)+" ")]),t.fixedTerm?s("em",{staticClass:"d-none d-lg-block"},[t._v(" "+t._s(t.dictionary("no_results_for"))+" "),s("s",[t._v(t._s(t.term))])]):t._e()])]:t._e(),s("transition",{attrs:{"enter-active-class":"animated fadeInDown","leave-active-class":"animated position-absolute fadeOutUp"}},[t.hasSelectedOptions?s("div",[s("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:t.clearFilters}},[s("span",{staticClass:"mr-1"},[s("i",{staticClass:"fas fa-trash-alt"})]),t._v(" "+t._s(t.dictionary("clear_filters"))+" ")]),t._l(t.selectedOptions,(function(e,r){return t._l(e,(function(e){return s("button",{staticClass:"btn m-1 btn-sm btn-light",attrs:{type:"button"},on:{click:function(s){return t.setFilterOption(r,e,!1)}}},[s("span",{staticClass:"mr-1"},[s("i",{staticClass:"fas fa-times"})]),t._v(" "+t._s(e)+" "),s("small",[t._v("\\ "+t._s(t.filterLabel(r)))])])}))}))],2):t._e()])],2),s("article",{staticClass:"ec-search-engine__retail"},[s("div",{staticClass:"row"},t._l(t.resultItems,(function(e){return s("div",{key:e._id,staticClass:"col-6 col-md-4 col-lg-3"},[t._t("product",[s("ec-product-card",{staticClass:"ec-search-engine__item",attrs:{lang:t.lang,storeId:t.storeId,product:e}})],null,{product:e})],2)})),0)]),s("transition",{attrs:{"enter-active-class":"animated fadeInDown","leave-active-class":"animated position-absolute fadeOutUp"}},[t.networkError?s("div",{staticClass:"alert alert-warning",attrs:{role:"alert"}},[s("h4",{staticClass:"alert-heading"},[t._v("Offline")]),"pt_br"===t.lang?[t._v(" Não foi possível buscar os produtos, por favor verifique sua conexão com a internet. ")]:[t._v(" Unable to fetch the products, please check your internet connection. ")],s("hr"),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.fetchItems(t.currentPage)}}},[s("i",{staticClass:"fas fa-search mr-1"}),t._v(" "+t._s(t.dictionary("search_again"))+" ")])],2):t._e()])],1):t._e()]),s("transition",{attrs:{"enter-active-class":"animated fadeInDown","leave-active-class":"animated fadeOutUp"}},[!t.searched||t.loadingMore?t._t("default",[s("div",{domProps:{innerHTML:t._s(t.prerenderedHTML)}})]):t._e()],2)],1)}),[],!1,null,null,null).exports;function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function d(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){u(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function u(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}e.default=(t={},e="search-engine")=>{const s=document.getElementById(e);if(s){const a=window.storefront.$overlay,i=new URLSearchParams(window.location.search);new r.default({data:{showFilters:!1},render(r){const n=this;return r(l,{attrs:{id:e},props:d({},t.props,{term:i.get("term"),page:parseInt(i.get("page"),10),brands:i.getAll("brands"),categories:i.getAll("categories"),navbarId:"header",showFilters:n.showFilters,prerenderedHTML:s.outerHTML}),on:{"update:showFilters"(t){n.showFilters=t,a&&(t?(a.show(),a.once("hide",()=>{n.showFilters=!1})):a.hide())}}})}}).$mount(s)}}}}]);
//# sourceMappingURL=49dd63ada79bbaeb2c61.js.map